ollama:
  enabled: true
  fullnameOverride: open-webui-ollama
  ollama:
    gpu:
      enabled: true
      type: nvidia
      number: 1
  runtimeClassName: nvidia
  persistentVolume:
    enabled: true
    accessModes:
      - ReadWriteMany
    storageClass: longhorn
    size: ${ollama_size}

nodeSelector:
  nvidia.com/gpu.present: "true"

extraEnvVars:
  - name: ENV
    value: "dev"
  - name: SHOW_ADMIN_DETAILS
    value: "false"
  - name: ENABLE_LOGIN_FORM
    value: "false"
  - name: ENABLE_OAUTH_SIGNUP
    value: "true"
  - name: ENABLE_OAUTH_ROLE_MANAGEMENT
    value: "true"
  - name: OAUTH_ALLOWED_ROLES
    value: "openwebui-user,openwebui-admin"
  - name: OAUTH_ADMIN_ROLES
    value: "openwebui-admin"
  - name: OAUTH_CLIENT_ID
    valueFrom:
      secretKeyRef:
        name: openwebui-authentik-secret
        key: client_id
  - name: OAUTH_CLIENT_SECRET
    valueFrom:
      secretKeyRef:
        name: openwebui-authentik-secret
        key: client_secret
  - name: OPENID_PROVIDER_URL
    value: "${openid_provider_url}"
  - name: OAUTH_PROVIDER_NAME
    value: "${openid_provider_name}"
  - name: OPENID_REDIRECT_URI
    value: "${openid_redirect_uri}"

runtimeClassName: nvidia

pipelines:
  enabled: true

tika:
  enabled: true

websocket:
  enabled: true
  url: redis://open-webui-redis:6379/0

redis-cluster:
  enabled: true
  fullnameOverride: open-webui-redis
  auth:
    enabled: true
  replica:
    replicaCount: 1

service:
  type: NodePort
  port: 80
  containerPort: 8080
  nodePort: "32000"

ingress:
  enabled: false
  class: traefik
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    cert-manager.io/cluster-issuer: ${cert_issuer}
  host: ${host}
  tls: true
  existingSecret: openwebui-tls

persistence:
  enabled: true
  size: ${storage_size}

